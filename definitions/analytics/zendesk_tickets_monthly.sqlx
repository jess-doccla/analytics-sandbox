config {
  type: "table",
  schema: "analytics",
  tags: ["zendesk"],
  description: "Monthly counts of tickets created",
  columns: {
    created_date: "Ticket creation month",
    count: "The number of tickets created"
  },
  dependencies: [
    "freshness_zendesk_tickets",
    "sources_src_zendesk_ticket_assertions_uniqueKey_0"
  ]
}

SELECT
  DATE_TRUNC(DATE(created_at), MONTH) AS created_month,
  COUNT(DISTINCT id) as count
FROM ${ref("src_zendesk_ticket")}
GROUP BY 1